AUI.add("aui-rating",function(r){var n=r.Lang,I=n.isBoolean,ae=n.isNumber,o=n.isString,y=function(A){return(A instanceof r.NodeList);},m=function(A){return(A instanceof r.Node);},K="a",s="",aa="boundingBox",M="canReset",e="clearfix",D="contentBox",H="defaultSelected",G="disabled",z=".",Q="element",h="elements",O="",S="helper",u="hover",T="href",f="javascript:;",B="id",k="input",V="inputName",ac="label",ag="labelNode",J="name",U="nodeName",q="off",v="on",t="rating",b="selectedIndex",g="showTitle",C="size",N="title",Y="value",a="itemClick",af="itemSelect",c="itemOut",R="itemOver",j=r.getClassName,F=j(S,e),ad=j(t,ac,Q),d=j(t,Q),P=j(t,Q,u),x=j(t,Q,v),l='<div class="'+ad+'"></div>';var p=r.Component.create({NAME:"rating",ATTRS:{disabled:{value:false,validator:I},canReset:{value:true,validator:I},defaultSelected:{value:0,writeOnce:true,validator:ae},elements:{validator:y},hiddenInput:{validator:m},inputName:{value:s,validator:o},label:{value:s,validator:o},labelNode:{valueFn:function(){return r.Node.create(l);},validator:m},selectedIndex:{value:-1,validator:ae},showTitle:{value:true,validator:I},size:{value:5,validator:function(A){return ae(A)&&(A>0);}},title:null,value:null},HTML_PARSER:{elements:function(A){return A.all(z+d);},label:function(L){var A=L.one(z+ad);if(A){return A.html();}},labelNode:z+ad},TPL:{render:['<tpl loop="size">','<tpl if="!parent.disabled">','<a class="{$ns}element" href="javascript:;"></a>',"</tpl>",'<tpl if="parent.disabled">','<span class="{$ns}element"></span>',"</tpl>","</tpl>"]},prototype:{initializer:function(){var A=this;A.inputElementsData={};A.after("labelChange",this._afterSetLabel);},renderUI:function(){var A=this;var L=A.get(D);L.addClass(F);A._parseInputElements();A._renderLabel();A._renderElements();},bindUI:function(){var A=this;A._createEvents();A.on("click",A._handleClickEvent);A.on("mouseover",A._handleMouseOverEvent);A.on("mouseout",A._handleMouseOutEvent);},syncUI:function(){var A=this;A._syncElements();A._syncLabelUI();},clearSelection:function(){var A=this;A.get(h).each(function(L){L.removeClass(x);L.removeClass(P);});},select:function(ai){var an=this;var aj=an.get(b);var al=an.get(M);if(al&&(aj==ai)){ai=-1;}an.set(b,ai);var L=an.get(b);var ah=an._getInputData(L);var ak=(N in ah)?ah.title:s;var am=(Y in ah)?ah.value:L;an.fillTo(L);an.set(N,ak);an.set(Y,am);var A=an.get("hiddenInput");A.setAttribute(N,ak);A.setAttribute(Y,am);},fillTo:function(L,ah){var A=this;A.clearSelection();if(L>=0){A.get(h).some(function(aj,ai){aj.addClass(ah||x);return(ai==Math.floor(L));});}},indexOf:function(L){var A=this;return A.get(h).indexOf(L);},_canFireCustomEvent:function(L){var A=this;var ah=L.domEvent.target;return !A.get(G)&&ah.hasClass(d);},_createElements:function(){var A=this;return A.renderTPL("render",{disabled:A.get(G),size:A.get(C)}).get("childNodes");},_createEvents:function(){var A=this;var L=function(ah,ai){A.publish(ah,{defaultFn:ai,queuable:false,emitFacade:true,bubbles:true});};L(a,this._defRatingItemClickFn);L(af,this._defRatingItemSelectFn);L(R,this._defRatingItemOverFn);L(c,this._defRatingItemOutFn);},_defRatingItemClickFn:function(ah){var A=this;var L=ah.domEvent;A.fire(af,{delegateEvent:ah,domEvent:L,ratingItem:L.target});},_defRatingItemSelectFn:function(L){var A=this;var ah=L.domEvent.target;A.select(A.indexOf(ah));},_defRatingItemOutFn:function(L){var A=this;A.fillTo(A.get(b));},_defRatingItemOverFn:function(ah){var A=this;var L=A.indexOf(ah.domEvent.target);A.fillTo(L,P);},_parseInputElements:function(){var A=this;var ai=A.get(aa);var L=ai.all(k);var aj=L.size();var ah=A.get(V);var ak=r.Node.create('<input type="hidden" />');if(aj>0){ah=ah||L.item(0).getAttribute(J);A.set(C,aj);var al=ai.getElementsByTagName("label");L.each(function(ap,ao){var aq=ap.get(B);var an=O;if(aq){var am=al.filter('[for="'+aq+'"]');if(am.size()){an=am.item(0).html();}}A.inputElementsData[ao]={content:an,value:ap.getAttribute(Y)||ao,title:ap.getAttribute(N)};});al.remove(true);L.remove(true);}if(ah){ak.setAttribute(J,ah);ai.appendChild(ak);}A.set("hiddenInput",ak);},_renderLabel:function(){var A=this;A.get(D).append(A.get(ag));},_renderElements:function(ah){var A=this;var L=A.get(D);var ah=A.get(h);if(!ah.size()){ah=A._createElements();A.set(h,ah);}ah.each(function(aj,ai){var al=A._getInputData(ai);var ak=al.content;var am=al.title||A.get(N)||ak;if(ak||am){aj.html(ak||am);}if(am&&A.get(g)){aj.setAttribute(N,am);}if(!aj.attr(T)&&(aj.get(U).toLowerCase()==K)){aj.setAttribute(T,f);}});L.append(ah.getDOM());},_syncElements:function(){var L=this;var A=L.get(H)-1;L.set(b,A);L.select();},_syncLabelUI:function(){var A=this;var L=A.get(ac);A.get(ag).html(L);},_getInputData:function(L){var A=this;return A.inputElementsData[L]||{};},_handleClickEvent:function(L){var A=this;if(A._canFireCustomEvent(L)){A.fire(a,{delegateEvent:L,domEvent:L.domEvent});}},_handleMouseOutEvent:function(L){var A=this;if(A._canFireCustomEvent(L)){A.fire(c,{delegateEvent:L,domEvent:L.domEvent});}},_handleMouseOverEvent:function(L){var A=this;if(A._canFireCustomEvent(L)){A.fire(R,{delegateEvent:L,domEvent:L.domEvent});}},_afterSetLabel:function(A){this._syncLabelUI();}}});var E="down",Z="thumb",ab="ThumbRating",w="up",X=j(t,Z,E),W=j(t,Z,w);var i=r.Component.create({NAME:ab,ATTRS:{size:{value:2,readOnly:true}},EXTENDS:p,TPL:{render:['<tpl loop="size">','<tpl if="!parent.disabled">','<a class="{$ans}rating-element {$ans}rating-element-off {$ans}rating-thumb-{[ $i == 0 ? "up" : "down" ]}" href="javascript:;"></a>',"</tpl>",'<tpl if="parent.disabled">','<span class="{$ans}rating-element {$ans}rating-element-off {$ans}rating-thumb-{[ $i == 0 ? "up" : "down" ]}"></span>',"</tpl>","</tpl>",]},prototype:{fillTo:function(A,L){this.clearSelection();if(A>=0){this.get(h).item(A).addClass(L||x);}},_syncElements:n.emptyFn}});r.Rating=p;r.StarRating=p;r.ThumbRating=i;},"@VERSION@",{requires:["aui-base","aui-component"],skinnable:true});